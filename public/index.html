<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Conference Streaming Test</title>

  <!-- Flowplayer -->
  <script src="flowplayer/flowplayer-3.2.13.min.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

</head>
<body>

    
<hr>
<div id="calls">

    <h2>{{ app_title }}</h2>
    <table>
      <thead>
        <td>Call name</td>
        <td>Phone</td>
        <td>Active</td>
        <td>Player</td>
      </thead>
      <tr v-for="call in calls">
        <td>{{ call.name }} </td>
        <td>{{ call.guestPinPhoneNumber }} </td>
        <td>{{ isActive(call) }} </td>
        <td>{{ playerType(call) }} </td>
     </tr>
    </table>
    <button v-on:click="reloadCalls">Reload call list</button>
</div>
<script>
  var calls_app = new Vue ({
    el: "#calls",
    data: {
      app_title: "Wowza Streaming Demo",
      calls: [ ]
    },
    methods: {
      isActive: function(call) {
        return call.streaming ? "Yes" : "No";
      },

      playerType: function(call) {
        if( call.streaming ) {
          return "Streaming"
        } else if (call.recordConference) {
          return "Playback";
        } else {
          return "No audio"
        }
      },
      reloadCalls: function () {
        this.calls = [
          {"id":1062,
           "name":"Dan Edwards' no record, streaming stream call",
           "isActive":true,
           "guestPinPhoneNumber":"18663854039",
           "guestPinTollPhoneNumber":"",
           "recordConference":false,
           "status":"Available",
           "streaming":true}
           , {"id":1063,
           "name":"Dan Edwards' record, streaming stream call",
           "isActive":true,
           "guestPinPhoneNumber":"18663854039",
           "guestPinTollPhoneNumber":"",
           "recordConference":true,
           "status":"Available",
           "streaming":true}
           , {"id":1064,
           "name":"Dan Edwards' no record, no stream stream call",
           "isActive":true,
           "guestPinPhoneNumber":"18663854039",
           "guestPinTollPhoneNumber":"",
           "recordConference":false,
           "status":"Available",
           "streaming":false}
           , {"id":1063,
           "name":"Dan Edwards' record, no streaming stream call",
           "isActive":true,
           "guestPinPhoneNumber":"18663854039",
           "guestPinTollPhoneNumber":"",
           "recordConference":true,
           "status":"Available",
           "streaming":false}
          ];
      }
    }
  })
</script>

<hr>
<div id="controls">
  <label>Stream: </label>
  <input type=text id="url"/>
  <input type=button id="reload_url" value="Reload" onclick="loadStream(1062)"/>
</div>

<div id="playback">
  <h3>Playback recording</h3>
  <div id="httpstreaming" style="display:block;width:350px; height:50px; background-color:#12699f;"></div>
</div>

<div id="live">
  <h3>Live streaming</h3>
  <div id="streaming" style="display:block;width:350px; height:50px; background-color:#12699f;"></div>
</div>

  <script language="JavaScript">
  var playbackPlayer = flowplayer("httpstreaming", 
                "flowplayer/flowplayer-3.2.18.swf", {
                  plugins: {
                    f4m: {
                      url: "flowplayer/flowplayer.f4m-3.2.10.swf"
                      
                    },
                    httpstreaming: {
                      url: "flowplayer/flowplayer.httpstreaming-3.2.11.swf"
                    }
                  }
                }
              );


var streamingPlayer = flowplayer("streaming", 
              "flowplayer/flowplayer-3.2.18.swf", {
                plugins: {
                  rtmp: {
                    url: "flowplayer.rtmp-3.2.13.swf",
                    netConnectionUrl: "rtmp://18.222.61.84:1935/live"
                  }
                }
              }
            );

  function loadStream( stream ) {
    console.log('loadStream(' + stream + ')');
    var clip = streamingPlayer.getClip();
    streamingPlayer.setClip( 
                  {
                    url: stream, 
                    provider: 'rtmp', 
                    autoPlay: false
                  });

    playbackPlayer.setClip(
                  {
                    url: "http://18.222.61.84:1935/live_record/" + stream + "/manifest.f4m?DVR",
                    urlResolvers: ['f4m'],
                    provider: 'httpstreaming',
                    autoPlay: false
                  });
  }
</script>






</body>
</html>